<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to Split a Huge CSV Excel Spreadsheet Into Separate Files | PicoDash</title><meta name=generator content="Hugo 0.98.0"><meta name=description content="Microsoft Excel is excellent at so many day-to-day tasks. But now and then, you encounter one of its shortcomings: the size of a spreadsheet. Read on to find out how to make an Excel spreadsheet smaller or split a large CSV file into multiple files.
Why Split a Large CSV Into Multiple Files? You might be thinking, “Why would I need to split a large Excel file into multiple smaller files?"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/normalize.css><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel=stylesheet type=text/css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cayman/css/cayman.css><link rel=apple-touch-icon sizes=180x180 href=./apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=./favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=./favicon-16x16.png><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css integrity=sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js integrity=sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script></head><body><section class=page-header><h1 class=project-name>PicoDash</h1><h2 class=project-tagline></h2><nav><a href=./index.html class=btn>Blog</a>
<a href=./sitemap.xml class=btn>Sitemap</a>
<a href=./index.xml class=btn>RSS</a></nav></section><section class=main-content><h1>How to Split a Huge CSV Excel Spreadsheet Into Separate Files</h1><div><strong>Publish date: </strong>2024-02-29</div><p>Microsoft Excel is excellent at so many day-to-day tasks. But now and then, you encounter one of its shortcomings: the size of a spreadsheet. Read on to find out how to make an Excel spreadsheet smaller or split a large CSV file into multiple files.</p><h2 id=why-split-a-large-csv-into-multiple-files>Why Split a Large CSV Into Multiple Files?</h2><p>You might be thinking, “Why would I need to split a large Excel file into multiple smaller files?” It's an interesting question, especially as Excel has a spreadsheet row limit of 1,048,576.</p><strong class=ad-zone-advertising-tag></strong><p>Over 1 million rows sounds phenomenal. However, hitting the row limit is easier than you think, especially during certain tasks. For example, if you're marketing via email, you might import a CSV file containing millions of email addresses.</p><p>The only problem is, how do you manage a spreadsheet with that many addresses in? Furthermore, what if someone sends you a CSV that is already over the limit (from another program)?</p><p>If that sounds like an issue you're likely to face, check out the following five ways to split a large CSV or Excel file into multiple smaller files.</p><strong class=ad-zone-advertising-tag></strong><p>Don't have a large CSV file handy but want to play along at home? I'm using the <a href=# rel="noopener noreferrer">COVID-19 Open Research Dataset</a> in the examples, which you can download and use too.</p><h2 id=break-up-csv-files-using-a-program>1. Break Up CSV Files Using a Program</h2><p>There are several useful CSV splitter programs out there. Here are two of the best. Fair warning, though, as these programs are working, they sometimes run into memory issues, which is a common problem for CSV-splitting programs.</p><h3 id=free-huge-csv-splitter><a href=# rel="noopener noreferrer">Free Huge CSV Splitter</a></h3><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2020/10/split-csv-file-program.png><p>The Free Huge CSV Splitter is a basic CSV splitting tool. You input the CSV file you want to split, the line count you want to use, and then select <strong>Split File</strong>. The line count determines the number of output files you end up with.</p><strong class=ad-zone-advertising-tag></strong><h3 id=csv-splitter><a href=#>CSV Splitter</a></h3><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2020/10/csv-splitter-split-large-file-1.png><p>CSV Splitter is the second tool. It offers much the same functionality as Free Huge CSV Splitter, albeit with a slightly sleeker design. It splits your CSV into small chunks rapidly, allowing you to determine the line count you want to use.</p><h2 id=use-a-batch-file>2. Use a Batch File</h2><p>Next up, <a href=#>create a programmable batch file</a>. You can use a batch file to process the CSV into smaller chunks, customizing the file to deliver different chunks.</p><p>Open a new text document, then copy and paste the following:</p><strong class=ad-zone-advertising-tag></strong><pre><code class="hljs bash">@<span class=hljs-built_in>echo</span> off<br>setlocal ENABLEDELAYEDEXPANSION<br>REM Edit this value to change the name of the file that needs splitting. Include the extension.<br>SET BFN=HCAHPSHospital.csv<br>REM Edit this value to change the number of lines per file.<br>SET LPF=2500<br>REM Edit this value to change the name of each short file. It will be followed by a number indicating <span class=hljs-built_in>where</span> it is <span class=hljs-keyword>in</span> the list.<br>SET SFN=HosptialSplitFile<br>REM Do not change beyond this line.<br>SET SFX=%BFN:~-3%<br>SET /A LineNum=0<br>SET /A FileNum=1<br>For /F "delims==" %%l <span class=hljs-keyword>in</span> (%BFN%) Do (<br>SET /A LineNum+=1<br><span class=hljs-built_in>echo</span> %%l &gt;&gt; %SFN%!FileNum!.%SFX%<br><span class=hljs-keyword>if</span> !LineNum! EQU !LPF! (<br>SET /A LineNum=0<br>SET /A FileNum+=1<br>)<br>)<br>endlocal<br>Pause<br></code></pre><p>You'll need to configure the batch file before running. I'll tell you what each command does, and you can alter it to suit the size of your batch file, as well as the required output.</p><ul><li><strong>"SET BFN=" </strong>should point to the CSV you need to break down</li><li>"<strong>SET LPF=" </strong>is the number of rows you'd like to limit your new file to</li><li><strong>"SET SFN=" </strong>is the new naming scheme for your split files</li></ul><p>Once you've entered your variables, head to <strong>File > Save As</strong>. Choose a filename, and select <strong>Save</strong>. Then, select your newly saved text file and press <strong>F2</strong> to rename it. Replace the <strong>.txt</strong> extension with <strong>.bat</strong> and press <strong>OK</strong> when the warning appears. Now, you can split your large CSV file into smaller output files.</p><strong class=ad-zone-advertising-tag></strong><h2 id=use-a-powershell-script-to-break-up-a-csv-file>3. Use a PowerShell Script to Break Up a CSV File</h2><p>You can <a href=#>use batch files for a wide range of day-to-day tasks</a>. But <a href=#>PowerShell scripts are faster</a>, especially for this type of processing and division.</p><p>The following script quickly cuts your large CSV into smaller files.</p><p>First up, press <strong>CTRL + X</strong> to open the Windows Power Menu, then select <strong>PowerShell</strong>. If PowerShell isn't an option, input <strong>powershell</strong> in your Start Menu search bar and select the Best Match.</p><p>Now, copy and paste the following script:</p><pre><code class="hljs bash"><span class=hljs-variable>$InputFilename</span> = Get-Content 'C:\file\location'<br><span class=hljs-variable>$OutputFilenamePattern</span> = 'output_done_'<br><span class=hljs-variable>$LineLimit</span> = 50000<br><span class=hljs-variable>$line</span> = 0<br><span class=hljs-variable>$i</span> = 0<br><span class=hljs-variable>$file</span> = 0<br><span class=hljs-variable>$start</span> = 0<br><span class=hljs-keyword>while</span> (<span class=hljs-variable>$line</span> -le <span class=hljs-variable>$InputFilename</span>.Length) {<br><span class=hljs-keyword>if</span> (<span class=hljs-variable>$i</span> -eq <span class=hljs-variable>$LineLimit</span> -Or <span class=hljs-variable>$line</span> -eq <span class=hljs-variable>$InputFilename</span>.Length) {<br><span class=hljs-variable>$file</span>++<br><span class=hljs-variable>$Filename</span> = "<span class=hljs-variable>$OutputFilenamePattern</span><span class=hljs-variable>$file</span>.csv"<br><span class=hljs-variable>$InputFilename</span>[<span class=hljs-variable>$start</span>..(<span class=hljs-variable>$line</span>-1)] | Out-File <span class=hljs-variable>$Filename</span> -Force<br><span class=hljs-variable>$start</span> = <span class=hljs-variable>$line</span>;<br><span class=hljs-variable>$i</span> = 0<br>Write-Host "<span class=hljs-variable>$Filename</span>"<br>}<br><span class=hljs-variable>$i</span>++;<br><span class=hljs-variable>$line</span>++<br>}</code></pre><p>Replace the file location in the first line with your CSV file, then run the script. The script outputs the smaller CSV files in your user directory. For example, my CSV files are found at C:\Users\Gavin with file name <strong>output_done_1.csv</strong>. You can change the output name by altering the <strong>$OutputFilenamePattern = 'output_done_'</strong> line.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2020/10/powershell-script-to-split-excel-csv-file-smaller.png><p>You can find the original script at <a href=# rel="noopener noreferrer">SPJeff</a>.</p><h2 id=break-up-a-large-csv-using-power-pivot>4. Break Up a Large CSV Using Power Pivot</h2><p>Your penultimate solution to breaking up a large CSV file into small bits doesn't actually break it down. Rather, it lets you load your massive CSV file into Excel and use the Power Pivot tool to open it. That's right; you can effectively ignore the Excel line limit and manage the file within the program.</p><strong class=ad-zone-advertising-tag></strong> <img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2020/10/use-power-pivot-to-break-up-csv-excel.jpg><p>You achieve this by creating a data link to the CSV file, then using Power Pivot to manage the contents. For a full explanation and tutorial, read <a href=# rel="noopener noreferrer">Jose Barreto's blog</a> detailing the process.</p><p>In short, Barreto creates a Pivot Table using “up to 8.5 million rows with no problem at all.” The above image comes from the blog post, showing a total of 2 million rows in use in Excel.</p><p>Remember, this process doesn't split the CSV into small chunks. However, it does mean you can manipulate the CSV in Excel, which is a very handy alternative. If you need more tips, find out <a href=#>how to use a Pivot Table for data analysis</a>.</p><h2 id=break-up-large-csv-online-using-split-csv>5. Break Up Large CSV Online Using Split CSV</h2><p>There are also online services that break your big CSV file into smaller bits. One such option is <a href=# rel="noopener noreferrer">Split CSV</a>, a free online CSV splitter.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2020/10/split-csv-online-splitting-tool.png><p>Split CSV managed the COVID-19 dataset fine, splitting it into handy chunks. As with other tools, you define the line count for each file and let it split it up. However, I didn't have a large CSV file to hand to test with, and, as such, your experience may vary.</p><p>Split CSV includes premium options, too. For a subscription fee, <a href=#>you can use a custom delimiter</a>, choose a selection of output file types, remove certain characters from the output files, and delete duplicate lines.</p><strong class=ad-zone-advertising-tag></strong><h2 id=break-down-your-csv-files-into-easily-manageable-chunks>Break Down Your CSV Files Into Easily Manageable Chunks</h2><p>You now have five solutions for breaking your CSV files into small bits, making them easy to manage. The solutions vary in speed and the size of the CSV files they can manage, so you may have to experiment to find the solution that works best for you. And the best part of all? These CSV splitting techniques work on Windows 10 and Windows 11. You can even use the online CSV splitting tool on macOS and Linux!</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7rq3KnqysnZ%2Bbe6S7zGirmp9fnby4edOoZKyonJ7Bbq2MoaygnV2YwLd5xLGanqRdrLyzt8GopqRlmaPBsHnSnqeeqpGpsm6yyKWcrGc%3D</p><footer class=site-footer><span class=site-footer-credits>Made with <a href=https://gohugo.io/>Hugo</a>. © 2022. All rights reserved.</span></footer></section><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>